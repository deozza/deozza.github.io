<!DOCTYPE html>
<html>
 <body>
<form id="checkMRZ" action="#" onSubmit="getValues();return false">
<div>
  <h1>Numero de carte (haut)</h1>
  <input type="text" id="numeroHaut" name="_numeroHaute" site="9" maxlength="9" required="required">
</div>
<div>
  <h1>Numero de carte (droite)</h1>
  <input type="number" id="numeroDroite" name="_numeroDroite" site="10" maxlength="10" required="required">
</div>

<div>
<h1>Identite</h1>
   <input type="text" id="nom" name="_nom" placeholder="Nom" maxlength="25" required="required"/>
   <input type="text" id="prenoms" name="_prenom" placeholder="Prénom" required="required"/>
</div>

<div>
<h1>Nationalite</h1>
  <input type="text" id="nationalite" name="_nationalite" placeholder="Nationalite" size="3" maxlength="3" required="required"/>
</div>

<div>
<h1>Date de naissance (AAMMJJ)</h1>
   <input type="number" id="Anaissance" name="_Anaissance" placeholder="Année de naissance (AA)" value=00 min="00" max="99" required="required"/>
   <input type="number" id="Mnaissance" name="_Mnaissance" placeholder="Mois de naissance (MM)" value=1 min="1" max="12" required="required"/>
   <input type="number" id="Jnaissance" name="_Jnaissance" placeholder="Jour de naissance (JJ)" value=1 min="1" max="31" required="required"/>
</div>

<div>
<h1>Date d'expiration (AAMMJJ)</h1>
   <input type="number" id="Aexpiration" name="_Aexpiration" placeholder="Année d'expiration' (AA)" value=00 min="00" max="99" required="required"/>
   <input type="number" id="Mexpiration" name="_Mexpiration" placeholder="Mois d'expiration (MM)" value=1 min="1" max="12" required="required"/>
   <input type="number" id="Jexpiration" name="_Jexpiration" placeholder="Jour d'expiration (JJ)" value=1 min="1" max="31" required="required"/>
</div>

<div>
<button type="submit">Verifier</button>
      <a href="./sejour.html">Nouveau</a>
</div>
</form>

<script>
function getValues() {
  var nom =         document.getElementById("nom").value.toString();
  var prenom =      document.getElementById("prenoms").value.toString();
  var total = completeNomPrenom(nom, prenom);

  var numeroH =      document.getElementById("numeroHaut").value.toString();
  var numeroD =      document.getElementById("numeroDroite").value.toString();

  var nationalite = document.getElementById("nationalite").value.toString();

  var Anaissance = document.getElementById("Anaissance").value.toString();
  var Mnaissance = document.getElementById("Mnaissance").value.toString();
  var Jnaissance = document.getElementById("Jnaissance").value.toString();
  var naissance = Anaissance.concat(Mnaissance, Jnaissance);

  var Aexpiration = document.getElementById("Aexpiration").value.toString();
  var Mexpiration = document.getElementById("Mexpiration").value.toString();
  var Jexpiration = document.getElementById("Jexpiration").value.toString();
  var expiration = Aexpiration.concat(Mexpiration, Jexpiration);

  var factor = [7,3,1];

  var str1 = "IR".concat(nationalite,numeroH);
console.log(str1);
  var c1 = cle1(str1  ,factor);
  var c2 = cle2(naissance,factor);

}

function completeNomPrenom(nom, prenom){
  nomReplace = nom.split(" ").join('<');
  nomReplace = nomReplace.split("'").join('<');

  prenomReplace = prenom.split("-").join("<");
  prenomReplace = prenomReplace.split(" ").join("<");
  total = nomReplace.concat("<<",prenomReplace);

  if(total.length<30){
      s = '<'.repeat(30-total.length);
      total = "".concat(total,s);
  }else{
    total = total.substr(0,30);
  }
  return total;
}

function cle1(str1, factor){
  var cle1 = 0;
  var resultat = 0;

  for(var i = 0; i < str1.length; i++){
    if(str1.charAt(i) == "<"){
      valeur = 0;
    }else if (str1.charAt(i).match(/[a-z]/i)) {
      valeur = str1.charCodeAt(i);
    }else if(str1.charAt(i).match(/[0-9]/i)){
      valeur = Number(str1.charAt(i));
    }
    resultat += valeur * factor[i%3];
  }
  cle1 = resultat%10;
  console.log(cle1);
}

function cle2(str2,factor){
  var cle2 = 0;
  var resultat = 0;

  for(var i = 0; i < str2.length; i++){
    valeur = Number(str2.charAt(i));
    resultat += valeur * factor[i%3];
  }
   c2 = resultat%10;
   console.log(c2);
}
</script>

</body>
</html>
